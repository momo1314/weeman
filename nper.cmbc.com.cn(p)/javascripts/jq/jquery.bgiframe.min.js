/* Copyright (c) 2006 Brandon Aaron (http://brandonaaron.net)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) 
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * $LastChangedDate: 2007-07-21 18:45:56 -0500 (Sat, 21 Jul 2007) $
 * $Rev: 2447 $
 *
 * Version 2.1.1
 */
(function($) {
	$.fn.bgIframe2 = $.fn.bgiframe2 = function(s) {
		
		if (checkIsIE() || checkIsChrome()) {
//		if ($.browser.msie ) {
//			if($(this).find("iframe").length > 0){
//				$(this).find("iframe").remove();
//			}
//			if($('> iframe')>0){
//				$('> iframe').remove();
//			}
			s = $.extend({
				top : 'auto',
				left : 'auto',
				width : 'auto',
				height : 'auto',
				opacity : true,
				zIndex : 'auto',
				src : 'about:blank'
			}, s || {});
			var prop = function(n) {
				return n && n.constructor == Number ? n + 'px' : n;
			}
			s.opacity = s.opacity !== false ? true : '';
			s.top = s.top == 'auto' ? 0 : prop(s.top);
			s.left = s.left == 'auto' ? 0 : prop(s.left);
			s.zIndex = s.zIndex == 'auto' ? -1 : s.zIndex;
//			s.width = s.width == 'auto' ? "expression(((parseInt(this.parentNode.currentStyle.borderTopWidth)||0)*-1)+'px')" : prop(s.width);
//			console.log("&&&" + s.height);
			s.height = s.height == 'auto' ? $(this).height() : prop(s.height);
//			console.log("---" + s.height);
			return this.each(function() {
//				if ($('> iframe.bgiframe', this).length == 0)
				if($(this).find("iframe").length == 0){
					var ele = document.createElement('iframe');
					ele.src=s.src;
					ele.width = $(this).width();
					//ele.height = $(this).height();
					ele.height = s.height;
					ele.style.zindex=s.zIndex;
					ele.style.zIndex=s.zIndex;
					ele.style.top = s.top;
					ele.style.left=s.left;
					ele.style.filter = "Alpha(Opacity='0')";
					ele.tabIndex = '-1';
					ele.frameBorder="0";
					ele.style.display='block';
					ele.style.position = 'absolute';
					ele.style.opacity = true;
					this.insertBefore(ele,this.firstChild);
//					vx.IE_GC(ele);
				}
			});
		}
		return this;
	};
	//if ($.browser.msie)
	if (checkIsIE())	
	{
		if ($.browser.version.indexOf('6.0') > -1)
		{
			$.fn.bgIframe = $.fn.bgiframe = $.fn.bgIframe2;
		}
	}
})(jQuery);


function checkIsIE(){
	var userAgent = navigator.userAgent, 
	rMsie = /(msie\s|trident.*rv:)([\w.]+)/;
	var ua = userAgent.toLowerCase();
	var match = rMsie.exec(ua);
	if (match != null) {
	    return true;
	}else{
	    return false;
	}
}

function checkIsChrome() {
	var userAgent = navigator.userAgent;
	var rChrome = /chrome\/([\d.]+)/;
	var ua = userAgent.toLowerCase();
	var match = rChrome.exec(ua);
	if(match != null) {
		return true;
	} else {
		return false;
	}
}